-- ROLES
CREATE TABLE ROLES (
    ID NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    NAME VARCHAR2(50) NOT NULL,
    DESCRIPTION VARCHAR2(200)
);

-- USERS
CREATE TABLE USERS (
    ID NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    USERNAME VARCHAR2(100) NOT NULL,
    PASSWORD VARCHAR2(200) NOT NULL,
    ACTIVE NUMBER(1) DEFAULT 1,
    CONSTRAINT UK_USERS_USERNAME UNIQUE (USERNAME)
);

-- USERS_ROLE
CREATE TABLE USERS_ROLE (
    USER_ID NUMBER NOT NULL,
    ROLE_ID NUMBER NOT NULL,
    CONSTRAINT PK_USERS_ROLE PRIMARY KEY (USER_ID, ROLE_ID),
    CONSTRAINT FK_USERSROLE_USER FOREIGN KEY (USER_ID) REFERENCES USERS(ID) ON DELETE CASCADE,
    CONSTRAINT FK_USERSROLE_ROLE FOREIGN KEY (ROLE_ID) REFERENCES ROLES(ID) ON DELETE CASCADE
);

-- INGREDIENTS
CREATE TABLE INGREDIENTS (
    ID NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    NAME VARCHAR2(100) NOT NULL,
    CONSTRAINT UK_INGREDIENT_NAME UNIQUE (NAME)
);

-- RECIPES
CREATE TABLE RECIPES (
    ID NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    NAME VARCHAR2(60) NOT NULL,
    PREPARATION_TIME VARCHAR2(50) NOT NULL,
    DESCRIPTION VARCHAR2(200) NOT NULL,
    DIFFICULTY VARCHAR2(10) NOT NULL,
    COUNTRY VARCHAR2(30) NOT NULL,
    TYPE VARCHAR2(30) NOT NULL,
    INSTRUCTION CLOB NOT NULL,
    CREATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    CONSTRAINT UK_RECIPE_NAME UNIQUE (NAME)
);

-- DETAILS_RECIPE
CREATE TABLE DETAILS_RECIPE (
    ID NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    RECIPE_ID NUMBER NOT NULL,
    INGREDIENT_ID NUMBER NOT NULL,
    INGREDIENT_AMOUNT VARCHAR2(100),
    CONSTRAINT FK_DETAILS_RECIPE FOREIGN KEY (RECIPE_ID) REFERENCES RECIPES(ID) ON DELETE CASCADE,
    CONSTRAINT FK_DETAILS_INGREDIENT FOREIGN KEY (INGREDIENT_ID) REFERENCES INGREDIENTS(ID) ON DELETE CASCADE
);
